<html>
<head>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title>Circular graphics - Twirling</title>
    <!--<script src="https://code.createjs.com/createjs-2015.05.21.min.js"></script>-->
    <script src="static/createjs-2015.05.21.min.js"></script>
    <script src="static/dayclock.js"></script>
    <style>
        body {
          background: #000000;
        }

        /*horizontally center the canvas*/
        #demoCanvas {
            display: block;
            margin: 0 auto;
        }
    </style>
    <script>
    	var stage;
        var circle;
        var animate = true;
        var rotateFactor = 1;

        function init() {
            var canvas = document.getElementById("demoCanvas");
            canvas.width = document.body.clientWidth; //document.width is obsolete
            canvas.height = document.body.clientHeight; //document.height is obsolete

            stage = new createjs.Stage(canvas);

            var xCenter = canvas.width / 2;
            var yCenter = canvas.height / 2;
            var maxRadius = Math.floor(Math.min(canvas.width / 2, canvas.height / 2));
            console.log("maxRadius " + maxRadius);

            var container = new createjs.Container();
		    stage.addChild(container);

            circle = new Circle(container, xCenter, yCenter);
            draw(circle, maxRadius);

            createjs.Ticker.addEventListener("tick", tick);
        }

        function draw(circle, maxRadius) {
            var start = 0;
            var end = 0.3333;
            // TODO this used to be set to 178 but now it's full screen, make the count fixed
            var h = maxRadius * 0.9;
            var hue = 180;
            while (h > 20) {
                // TODO use hue to rgb conversion instead
                circle.addCell({radius: h -= 5, height: 8, start: start, end: end, color: "rgb(" + Math.trunc(hue/1.3) + ", 44, " + (255 - Math.trunc(hue/1.8)) + ")", alpha: 0.9, rotateRate: 10 - h/20});
                hue -= 5;
            }
        }

        function tick(event) {

            if (animate) {
                circle.update();

                stage.update(event);
            }
        }

    </script>
</head>
<body onload="init();">
<canvas id="demoCanvas"></canvas>
</body>
</html>