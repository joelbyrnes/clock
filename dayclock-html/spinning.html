<html>
<head>
    <title>DayClock</title>
    <!--<script src="https://code.createjs.com/createjs-2015.05.21.min.js"></script>-->
    <script src="static/createjs-2015.05.21.min.js"></script>
    <script src="static/dayclock.js"></script>
    <style>
        body {
          background: #000000;
        }

        /*horizontally center the canvas*/
        #demoCanvas {
            display: block;
            margin: 0 auto;
        }
    </style>
    <script>
    	var canvas, stage;
        var face;
        var animate = true;
        var rotateFactor = 1;

        function init() {
            canvas = document.getElementById("demoCanvas");
            stage = new createjs.Stage(canvas);

            var xCenter = canvas.width / 2;
            var yCenter = canvas.height / 2;

            face = new createjs.Container();
		    stage.addChild(face);

            // TODO can get x y from face?
            draw(face, xCenter, yCenter);

            createjs.Ticker.addEventListener("tick", tick);
        }

        function draw(face, xCenter, yCenter) {
            var start = 0;
            var end = 0.3333;

            var cells = [
                {name: "ring", radius:180, height: 2, start: 0, end: 1, color: "#00ee00"},
                {name: "D", radius:170, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 0.6},
                {name: "D", radius:160, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 0.7},
                {name: "D", radius:150, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 0.8},
                {name: "D", radius:140, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 0.9},
                {name: "D", radius:130, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 1},
                {name: "D", radius:120, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 1.1},
                {name: "D", radius:110, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 1.2},
                {name: "D", radius:100, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 1.3},
                {name: "D", radius:90, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 1.4},
                {name: "D", radius:80, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 1.5},
                {name: "D", radius:70, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 1.6},
                {name: "D", radius:60, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 1.7},
                {name: "D", radius:50, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 1.8},
                {name: "D", radius:40, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 1.9},
                {name: "D", radius:30, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 2.0},
                {name: "D", radius:20, height: 10, start: start, end: end, color: "lightgreen", rotateRate: 2.1}
            ];

//            addCells(face, xCenter, yCenter, cells);

            //face.addChild(createCell(xCenter, yCenter, {name: "ring", radius:180, height: 2, start: 0, end: 1, color: "#00ee00"}));

            var h = 178;
            while (h > 20) {
                // TODO use hue to rgb conversion instead
                face.addChild(createCell(xCenter, yCenter,
                        {radius:h -= 5, height: 8, start: start, end: end, color: "rgb(" + Math.trunc(h/1.3) + ", 44, " + (255 - Math.trunc(h/1.8)) + ")", alpha: 0.9, rotateRate: 10 - h/20}));
            }
        }

        function tick(event) {

            if (animate) {
                for (var i=0; i < face.numChildren; i++) {
                    var child = face.getChildAt(i);
                    child.rotation += child.rotateRate * rotateFactor;
                }

                stage.update(event);
            }
        }

    </script>
</head>
<body onload="init();">
<canvas id="demoCanvas" width="400" height="400"></canvas>
</body>
</html>